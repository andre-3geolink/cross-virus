---
// import SvelteMap from "../components/svelte/MapDrag.svelte";
import MapWrapper from "../components/svelte/PolygonSearch/ScenePolygonCharts.svelte";

import Layout from "../layouts/MapLayout.astro";

// ID DO MAPA ARCGIS
let mapID = "a08e05ffc384476eb4a8f30ee8bf0ae8";

let sql_filter = [
  {
    onStatisticField: "CASE WHEN sexo = 'F' THEN 1 ELSE 0 END",
    outStatisticFieldName: "feminino",
    statisticType: "sum",
  },
  {
    onStatisticField: "CASE WHEN idade LIKE  '%1 Ano%' THEN 1 ELSE 0 END",
    outStatisticFieldName: "menor1",
    statisticType: "sum",
  },
  {
    onStatisticField: "CASE WHEN idade LIKE  '%1 a 4%'  THEN 1 ELSE 0 END",
    outStatisticFieldName: "de_1_4_anos",
    statisticType: "sum",
  },
  {
    onStatisticField: "CASE WHEN idade LIKE  '%5 a 9%'  THEN 1 ELSE 0 END",
    outStatisticFieldName: "de_5_9_anos",
    statisticType: "sum",
  },
  {
    onStatisticField: "CASE WHEN idade LIKE  '%10 a 14%'  THEN 1 ELSE 0 END",
    outStatisticFieldName: "de_10_14_anos",
    statisticType: "sum",
  },
  {
    onStatisticField: "CASE WHEN idade LIKE  '%15 a 19%'  THEN 1 ELSE 0 END",
    outStatisticFieldName: "de_15_19_anos",
    statisticType: "sum",
  },
  {
    onStatisticField: "CASE WHEN idade LIKE  '%20 a 29%'  THEN 1 ELSE 0 END",
    outStatisticFieldName: "de_20_29_anos",
    statisticType: "sum",
  },
  {
    onStatisticField: "CASE WHEN idade LIKE  '%30 a 39%'  THEN 1 ELSE 0 END",
    outStatisticFieldName: "de_30_39_anos",
    statisticType: "sum",
  },
  {
    onStatisticField: "CASE WHEN idade LIKE  '%40 a 49%'  THEN 1 ELSE 0 END",
    outStatisticFieldName: "de_40_49_anos",
    statisticType: "sum",
  },
  {
    onStatisticField: "CASE WHEN idade LIKE  '%50 a 59%'  THEN 1 ELSE 0 END",
    outStatisticFieldName: "de_50_59_anos",
    statisticType: "sum",
  },
];
---

<Layout title="Mapa" maps={[]}>
  <MapWrapper
    client:only
    mapConfig={{
      mapID,
      options: {
        filter: {
          fieldNames: ["SEXO", "IDADE", "MES", "ANO"],
          layerName: "Covidfinal",
        },
      },
      charts: [
        {
          chart: {
            type: "bar",
            data: {
              labels: [
                "< 1 ano",
                "1-4 anos",
                "5-9 anos",
                "10-14 anos",
                "15-19 anos",
                "20-29 anos",
                "30-39 anos",
                "40-49 anos",
                "50-59 anos",
                "acima de 60 anos",
              ],
              datasets: [
                {
                  label: "Faixa etária",
                  backgroundColor: "#149dcf",
                  stack: "Stack 0",
                  data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                },
              ],
            },
            options: {
              responsive: false,
              legend: {
                display: false,
              },
              title: {
                display: true,
                text: "Faixa etária",
              },
              // scales: {
              //   xAxes: [
              //     {
              //       stacked: true,
              //       ticks: {
              //         beginAtZero: true,
              //         precision: 0,
              //       },
              //     },
              //   ],
              //   yAxes: [
              //     {
              //       stacked: true,
              //     },
              //   ],
              // },
            },
          },
          sql_filter: [
            {
              onStatisticField:
                "CASE WHEN idade LIKE  '%1 Ano%' THEN 1 ELSE 0 END",
              outStatisticFieldName: "menor1",
              statisticType: "sum",
            },
            {
              onStatisticField:
                "CASE WHEN idade LIKE  '%1 a 4%'  THEN 1 ELSE 0 END",
              outStatisticFieldName: "de_1_4_anos",
              statisticType: "sum",
            },
            {
              onStatisticField:
                "CASE WHEN idade LIKE  '%5 a 9%'  THEN 1 ELSE 0 END",
              outStatisticFieldName: "de_5_9_anos",
              statisticType: "sum",
            },
            {
              onStatisticField:
                "CASE WHEN idade LIKE  '%10 a 14%'  THEN 1 ELSE 0 END",
              outStatisticFieldName: "de_10_14_anos",
              statisticType: "sum",
            },
            {
              onStatisticField:
                "CASE WHEN idade LIKE  '%15 a 19%'  THEN 1 ELSE 0 END",
              outStatisticFieldName: "de_15_19_anos",
              statisticType: "sum",
            },
            {
              onStatisticField:
                "CASE WHEN idade LIKE  '%20 a 29%'  THEN 1 ELSE 0 END",
              outStatisticFieldName: "de_20_29_anos",
              statisticType: "sum",
            },
            {
              onStatisticField:
                "CASE WHEN idade LIKE  '%30 a 39%'  THEN 1 ELSE 0 END",
              outStatisticFieldName: "de_30_39_anos",
              statisticType: "sum",
            },
            {
              onStatisticField:
                "CASE WHEN idade LIKE  '%40 a 49%'  THEN 1 ELSE 0 END",
              outStatisticFieldName: "de_40_49_anos",
              statisticType: "sum",
            },
            {
              onStatisticField:
                "CASE WHEN idade LIKE  '%50 a 59%'  THEN 1 ELSE 0 END",
              outStatisticFieldName: "de_50_59_anos",
              statisticType: "sum",
            },
          ],
        },

        {
          chart: {
            type: "bar",
            data: {
              labels: [
                "jan-21",
                "fev-21",
                "mar-21",
                "abr-21",
                ",mai-21",
                "jun-21",
              ],
              datasets: [
                {
                  label: "Casos Notificados (2021)",
                  backgroundColor: "#149dcf",
                  stack: "Stack 0",
                  data: [0, 0, 0, 0, 0, 0],
                },
              ],
            },
            options: {
              responsive: true,
              legend: {
                position: "top",
              },
              title: {
                display: true,
                text: "Casos por mês/ano",
              },
              // scales: {
              //   xAxes: [
              //     {
              //       stacked: true,
              //     },
              //   ],
              //   yAxes: [
              //     {
              //       stacked: true,
              //       ticks: {
              //         beginAtZero: true,
              //       },
              //     },
              //   ],
              // },
            },
          },
          sql_filter: [
            {
              onStatisticField:
                "CASE WHEN mes = 1 AND ano = 2021 THEN 1 ELSE 0 END",
              outStatisticFieldName: "jan_2021",
              statisticType: "sum",
            },
            {
              onStatisticField:
                "CASE WHEN mes = 2 AND ano = 2021 THEN 1 ELSE 0 END",
              outStatisticFieldName: "fev_2021",
              statisticType: "sum",
            },
            {
              onStatisticField:
                "CASE WHEN mes = 3 AND ano = 2021 THEN 1 ELSE 0 END",
              outStatisticFieldName: "mar_2021",
              statisticType: "sum",
            },
            {
              onStatisticField:
                "CASE WHEN mes = 4 AND ano = 2021 THEN 1 ELSE 0 END",
              outStatisticFieldName: "abr_2021",
              statisticType: "sum",
            },
            {
              onStatisticField:
                "CASE WHEN mes = 5 AND ano = 2021 THEN 1 ELSE 0 END",
              outStatisticFieldName: "mai_2021",
              statisticType: "sum",
            },
            {
              onStatisticField:
                "CASE WHEN mes = 6 AND ano = 2021 THEN 1 ELSE 0 END",
              outStatisticFieldName: "jun_2021",
              statisticType: "sum",
            },
          ],
        },

        {
          chart:{
        type: "doughnut",
        data: {
          labels: ["Masculino", "Feminino"],
          datasets: [
            {
              backgroundColor: [
                "#FD7F6F",
                "#7EB0D5",
                "#B2E061",
                "#BD7EBE",
                "#FFB55A",
              ],
              borderWidth: 0,
              data: [0, 0],
            },
          ],
        },
        options: {
          responsive: false,
          cutoutPercentage: 35,
          legend: {
            position: "bottom",
          },
          title: {
            display: true,
            text: "Sexo",
          },
        },
      },
      sql_filter:[ {
          onStatisticField: "CASE WHEN sexo = 'M' THEN 1 ELSE 0 END",
          outStatisticFieldName: "masculino",
          statisticType: "sum",
        },
        {
          onStatisticField: "CASE WHEN sexo = 'F' THEN 1 ELSE 0 END",
          outStatisticFieldName: "feminino",
          statisticType: "sum",
        },]
        }
      ],
    }}
  />
</Layout>
